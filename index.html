<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Picker</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>
    <main>
        <h1>Color Picker</h1>
        <label class="switch">
            <input id="input" type="checkbox" checked="darkTheme"/>
            <div class="slider round">
                <div class="sun-moon">
                    <svg id="moon-dot-1" class="moon-dot" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="moon-dot-2" class="moon-dot" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="moon-dot-3" class="moon-dot" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="light-ray-1" class="light-ray" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="light-ray-2" class="light-ray" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="light-ray-3" class="light-ray" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    
                    <svg id="cloud-1" class="cloud-dark" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="cloud-2" class="cloud-dark" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="cloud-3" class="cloud-dark" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="cloud-4" class="cloud-light" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="cloud-5" class="cloud-light" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                    <svg id="cloud-6" class="cloud-light" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="50"></circle>
                    </svg>
                </div>
                <div class="stars">
                    <svg id="star-1" class="star" viewBox="0 0 20 20">
                        <path d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"></path>
                    </svg>
                    <svg id="star-2" class="star" viewBox="0 0 20 20">
                        <path d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"></path>
                    </svg>
                    <svg id="star-3" class="star" viewBox="0 0 20 20">
                        <path d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"></path>
                    </svg>
                    <svg id="star-4" class="star" viewBox="0 0 20 20">
                        <path d="M 0 10 C 10 10,10 10 ,0 10 C 10 10 , 10 10 , 10 20 C 10 10 , 10 10 , 20 10 C 10 10 , 10 10 , 10 0 C 10 10,10 10 ,0 10 Z"></path>
                    </svg>
                </div>
            </div>
        </label>

        <div class="boxes">
            <div class="picker">
                <div class="primary">
                    <label class="box"><input type="color" id="colorInput1" value="#ff0000"></input></label>
                </div>
                <div class="secondary">
                    <label class="box"><input type="color" id="colorInput2" value="#00ffff"></input></label>
                </div>
            </div>
            <div class="containers">
                <section class="cont-accents">
                    <h2>Accent Colors</h2>
                    <div class="box accent light"><span class="copyme"></span></div>
                    <div class="box accent dark"><span class="copyme"></span></div>
                </section>
                <section class="cont-analogs">
                    <h2>Analog Colors</h2>
                    <div class="box analog left"><span class="copyme"></span></div>
                    <div class="box analog right"><span class="copyme"></span></div>
                </section>
                <section class="cont-complements">
                    <h2>Complement Colors</h2>
                    <div class="box complement left"><span class="copyme"></span></div>
                    <div class="box complement center"><span class="copyme"></span></div>
                    <div class="box complement right"><span class="copyme"></span></div>
                </section>
                <section class="cont-triads">
                    <h2>Triad Colors</h2>
                    <div class="box triad left"><span class="copyme"></span></div>
                    <div class="box triad right"><span class="copyme"></span></div>
                </section>
                <section class="cont-monos">
                    <h2>Mono Colors</h2>
                    <div class="tint">
                        <h3>Tints</h3>
                        <div class="box tint1"><span class="copyme"></span></div>
                        <div class="box tint2"><span class="copyme"></span></div>
                        <div class="box tint3"><span class="copyme"></span></div>
                    </div>
                    <div class="shade">
                        <h3>Shades</h3>
                        <div class="box shade1"><span class="copyme"></span></div>
                        <div class="box shade2"><span class="copyme"></span></div>
                        <div class="box shade3"><span class="copyme"></span></div>
                    </div>
                    <div class="tones">
                        <h3>Tones</h3>
                        <div class="box tone1"><span class="copyme"></span></div>
                        <div class="box tone2"><span class="copyme"></span></div>
                        <div class="box tone3"><span class="copyme"></span></div>
                    </div>
                </section>
                <section class="cont-gradient">
                    <h2>Gradient</h2>
                    <div class="box gradient" color1="#ff0000" color2="#00ffff"><span class="copyme"></span></div>
                </section>
            </div>
        </div>
    </main>
    
    <footer>
        <p>This is a practice for using the new CSS baseline features <span>(color-scheme, relative colors, CSS Houdini - @property)</span>.</p>
        <small>Color calculations are all done by the CSS, scripting are just for setting attribute data and copying hashes</small>

        <script>
            const swatch1 = document.getElementById('colorInput1')
            const swatch2 = document.getElementById('colorInput2')
            const swatches = [swatch1, swatch2]
            const colorboxes = [...document.querySelectorAll('section[class^="cont"]:not(.cont-gradient) .box')]
            const copySpans = document.querySelectorAll('.copyme')

            document.addEventListener('DOMContentLoaded', function(){
                const hx = getComputedColors(colorboxes)
                copySpans.forEach((span, i) => span.textContent = hx[i])
            })

            for(i = 0; i < swatches.length; i++){
                let index = i
                
                swatches[i].addEventListener('input', function(e){
                    if(index === 0) document.documentElement.style.setProperty('--box-color', e.target.value)
                    else if(index === 1) document.documentElement.style.setProperty('--box-secondary-color', e.target.value)

                    setDefaultGradient()
                })

                swatches[i].addEventListener('change', function(e){
                    const hx = getComputedColors(colorboxes)
                    copySpans.forEach((span, i) => span.textContent = hx[i])
                })
            }

            colorboxes.forEach(box => {
                box.addEventListener('click', function(){
                    const color = box.innerText
                    navigator.clipboard.writeText(color)
                    .then(() => {
                        box.innerHTML = `<span class="copyme">Copied!</span>`
                        box.classList.add('copied')
                        setTimeout(() => {
                            box.classList.remove('copied')
                            box.innerHTML = `<span class="copyme">${color}</span>`
                        }, 1000)
                    })
                    .catch(err => console.error('Error copying to clipboard: ', err))
                })
            })

            const setDefaultGradient = () => {
                document.querySelector('.cont-gradient .box').setAttribute('color1', swatch1.value)
                document.querySelector('.cont-gradient .box').setAttribute('color2', swatch2.value)
            }

            const getComputedColors = (elements = []) => {
                let hexColors = []
                
                elements.forEach(el => {
                    const elemBg = getComputedStyle(el).backgroundColor
                    const [r, g, b] = elemBg
                    .match(/\d+(\.\d+)?/g)
                    .map(x => {
                        x = Math.round(parseFloat(x) * 255).toString(16)
                        return x.length === 1 ? '0' + x : x
                    })
                    
                    const hex = '#' + [r, g, b].join('')
                    hexColors.push(hex)
                })
                
                return hexColors
            }
        </script>
    </footer>
</body>
</html>